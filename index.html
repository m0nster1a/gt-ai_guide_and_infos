<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Database</title>
    <style>
        /* 1. LAYOUT SETUP */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            display: flex;
            height: 100vh; /* Full screen height */
            overflow: hidden; /* Stop whole page scrolling, only content scrolls */
        }

        /* 2. SIDEBAR NAVIGATION */
        .sidebar {
            width: 250px;
            background-color: #1e1e1e;
            border-right: 1px solid #333;
            display: flex;
            flex-direction: column;
            padding: 20px;
            flex-shrink: 0; /* Prevents sidebar from squishing */
        }

        .sidebar h2 {
            color: #4CAF50;
            margin-top: 0;
            font-size: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-align: center;
            margin-bottom: 30px;
        }

        .nav-btn {
            background: none;
            border: none;
            color: #aaa;
            padding: 15px;
            text-align: left;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            margin-bottom: 5px;
            transition: 0.2s;
        }

        .nav-btn:hover {
            background-color: #333;
            color: white;
            padding-left: 20px; /* Slide effect */
        }

        .nav-btn.active {
            background-color: #2e7d32;
            color: white;
            font-weight: bold;
        }

        /* 3. MAIN CONTENT AREA */
        .content {
            flex-grow: 1;
            padding: 40px;
            overflow-y: auto; /* Allows scrolling only in this area */
        }

        h1 { margin-top: 0; color: #fff; border-bottom: 1px solid #333; padding-bottom: 15px;}

        /* 4. TABLE STYLING (Same as before) */
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: #1e1e1e;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 20px;
        }

        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #333; }
        th { background-color: #2c2c2c; color: #4CAF50; text-transform: uppercase; font-size: 14px; }
        tr:hover { background-color: #252525; }

    </style>
</head>
<body>

    <!-- LEFT SIDEBAR -->
    <div class="sidebar">
        <h2>Wiki Menu</h2>
        <!-- Navigation Buttons -->
        <button class="nav-btn active" onclick="showPage('home', this)">üè† Home</button>
        <button class="nav-btn" onclick="showPage('loot', this)">‚öîÔ∏è Loot Table</button>
        <!-- You can add more buttons here later -->
    </div>

    <!-- RIGHT CONTENT AREA -->
    <div class="content" id="mainDisplay">
        <!-- Content gets injected here by JavaScript -->
    </div>

<script>
    // 1. Run this when page loads (Starts at Home)
    window.onload = function() {
        showPage('home', document.querySelector('.nav-btn'));
    };

    // 2. The Master Function to switch pages
    function showPage(pageName, btnClicked) {
        const display = document.getElementById('mainDisplay');
        
        // Update Button Styling (Highlight the active one)
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        if(btnClicked) btnClicked.classList.add('active');

        // Logic for what to show
        if (pageName === 'home') {
            display.innerHTML = `
                <h1>Welcome to the Game Tracker</h1>
                <p>Select an option from the menu on the left to view data.</p>
                <p>This site tracks all official loot and items.</p>
            `;
        } 
        else if (pageName === 'loot') {
            display.innerHTML = `<h1>Loot Table</h1><p id="status">Loading data...</p>`;
            loadCsvData(); // Trigger the CSV loader
        }
    }

    // 3. The CSV Loader (Reused from previous step)
    function loadCsvData() {
        // We add the random number (?v=...) to ensure we get the latest file version
        fetch('data.csv?v=' + new Date().getTime())
            .then(response => response.text())
            .then(data => {
                const rows = data.split('\n');
                
                // Start building the table HTML
                let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Category</th>
                            <th>Qty</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>`;

                // Loop through rows (start at 1 to skip headers)
                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i].trim();
                    if (row) {
                        const cols = row.split(',');
                        // Handle cases where description has commas
                        const desc = cols.slice(3).join(',') || "";
                        
                        tableHTML += `
                        <tr>
                            <td style="font-weight:bold; color:#fff">${cols[0] || ""}</td>
                            <td style="color:#aaa; font-style:italic">${cols[1] || ""}</td>
                            <td>${cols[2] || ""}</td>
                            <td>${desc}</td>
                        </tr>`;
                    }
                }

                tableHTML += `</tbody></table>`;
                
                // Remove the "Loading..." text and add the table
                const status = document.getElementById('status');
                if(status) status.remove();
                
                document.getElementById('mainDisplay').insertAdjacentHTML('beforeend', tableHTML);
            })
            .catch(error => {
                document.getElementById('mainDisplay').innerHTML += `<p style="color:red">Error: Could not find data.csv. Did you upload it?</p>`;
            });
    }
</script>

</body>
</html>
